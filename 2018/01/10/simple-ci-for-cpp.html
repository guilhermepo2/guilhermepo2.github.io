<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="description" content="just a programmer's website, nothing to see here"><meta property="og:image" content="https://gueepo.me/images/artdel_pfp.jpg"/><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="https://gueepo.me/assets/css/syntax.css"><link rel="preconnect" href="https://cdnjs.cloudflare.com"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><title> Setting Up Circle CI on GitHub for C++ and CMake - gueepo</title><link rel="shortcut icon" href="https://gueepo.me/favicon.png"><link rel="alternate" type="application/atom+xml" title="gueepo" href="https://gueepo.me/atom.xml"><link rel="alternate" type="application/json" title="gueepo" href="https://gueepo.me/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="https://gueepo.me/sitemap.xml" /><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Play:wght@400;700&family=Source+Code+Pro:ital,wght@0,200;0,300;0,400;0,600;0,700;0,900;1,300;1,400;1,500;1,600;1,700;1,900&display=swap" rel="stylesheet"><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}html{font-size:15px}#theme-toggle{opacity:0.65;position:relative;border-radius:5px;height:25px;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;transition:opacity 0.3s ease 0s;border:none;outline:none;background:none;cursor:pointer;padding:0px;appearance:none;transform:scale(0.8)}html,html[data-theme="light"]{--text-font: Play;--source-code-font: Source Code Pro;--very-light-text-color: rgb(222, 222, 222);--light-text-color: rgb(89, 183, 255);--medium-text-color: #555;--main-text-color: #333;--highlight-text-color: #6cb4a0;--dark-text-color: #393e46;--link-color: rgb(50, 87, 209);--code-bg-color: rgb(245, 245, 245);background-color:#fff}html #theme-toggle div,html[data-theme="light"] #theme-toggle div{position:relative;width:24px;height:24px;border-radius:50%;border:none;background-color:var(--theme-ui-colors-transparent, transparent);transform:scale(1);transition:all 0.45s ease 0s;overflow:hidden;box-shadow:inset 8px -8px 0px 0px var(--theme-ui-colors-toggleIcon, #2d3748)}html #theme-toggle div::before,html[data-theme="light"] #theme-toggle div::before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:none;border-radius:50%;transform:translate(0px, 0px);opacity:1;transition:transform 0.45s ease 0s}html #theme-toggle div::after,html[data-theme="light"] #theme-toggle div::after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0px 0px -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon, #2d3748),0 23px 0 var(--theme-ui-colors-toggleIcon, #2d3748),23px 0 0 var(--theme-ui-colors-toggleIcon, #2d3748),-23px 0 0 var(--theme-ui-colors-toggleIcon, #2d3748),15px 15px 0 var(--theme-ui-colors-toggleIcon, #2d3748),-15px 15px 0 var(--theme-ui-colors-toggleIcon, #2d3748),15px -15px 0 var(--theme-ui-colors-toggleIcon, #2d3748),-15px -15px 0 var(--theme-ui-colors-toggleIcon, #2d3748);transform:scale(0);transition:all 0.35s ease 0s}html[data-theme="dark"]{--text-font: Play;--source-code-font: Source Code Pro;--very-light-text-color: #EEE;--light-text-color: #c4bbf0;--medium-text-color: #52057b;--main-text-color: #EAEAEA;--highlight-text-color: #6cb4a0;--dark-text-color: rgb(36, 38, 42);--link-color: rgb(255, 89, 125);--code-bg-color: rgb(36, 38, 42);background-color:#131418}html[data-theme="dark"] #theme-toggle div{position:relative;width:24px;height:24px;border-radius:50%;border:4px solid var(--theme-ui-colors-toggleIcon, #cbd5e0);background-color:var(--theme-ui-colors-toggleIcon, #cbd5e0);transform:scale(0.55);transition:all 0.45s ease 0s;overflow:visible;box-shadow:none}html[data-theme="dark"] #theme-toggle div::before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:2px solid var(--theme-ui-colors-toggleIcon, #cbd5e0);border-radius:50%;transform:translate(14px, -14px);opacity:0;transition:transform 0.45s ease 0s}html[data-theme="dark"] #theme-toggle div::after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0px 0px -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),0 23px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),23px 0 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),-23px 0 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),15px 15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),-15px 15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),15px -15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),-15px -15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0);transform:scale(1);transition:all 0.35s ease 0s}body{font-family:var(--text-font),monospace;text-rendering:optimizeLegibility;line-height:1.75;color:var(--main-text-color)}a{color:var(--link-color);text-decoration:none}.post p{margin:1rem 0}.meta{margin:1.4rem 0}code,pre{background:var(--code-bg-color);margin:0 -27px;border-width:1px}code{font-family:var(--source-code-font),monospace;margin:unset;padding:0.1rem;color:var(--highlight-text-color)}pre code{background-color:unset;color:unset}pre{border-width:3px;padding:0.8rem;white-space:pre-wrap;border-style:none none none solid;border-color:var(--light-text-color)}img{max-width:100%}hr{background:var(--light-text-color);height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:0.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem 0}section{margin-top:8rem}blockquote{font-style:italic;border-left:5px solid var(--dark-text-color);padding-left:1rem}h1{color:var(--main-text-color);text-transform:uppercase;font-size:2rem;font-weight:bold;margin-bottom:1.5rem}h2,h3,h4,h5{font-weight:bold;margin-bottom:1.5rem;font-size:2rem}h2{font-size:1.8rem}h3{font-size:1.6rem}h4{font-size:1.4rem}h5{font-size:1.2rem}h6{font-size:1rem}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:0.5rem}.posts>h3{font-weight:500}.post ul{margin:0px;margin:0px 0px 10px 10px}.post ol{margin:0px;margin:0px 0px 10px 15px}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:0.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:bold}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}time{color:var(--main-text-color)}.post>h1.title{font-size:x-large;margin-top:0;margin-bottom:0}.post>time{margin-bottom:0;margin-top:3rem}.highlight{margin:0px}main{display:flex;max-width:47rem;margin:-5rem auto 0;padding-top:2.4rem;padding-bottom:0.0rem;padding-left:2rem;padding-right:2rem;flex-direction:column}.flex-row-between{display:flex;flex-direction:row;justify-content:space-between}.social-footer{padding:1rem;display:flex;justify-content:center;position:initial}.social-footer .social-footer-icons .fa{font-size:1.3rem;color:#a9a9a9}.social-footer .social-footer-icons .fa:hover{color:dimgray;transition:color 0.3s ease-in}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:0.5rem}main{padding:0 2rem}}section{flex-grow:999;display:flex;flex-direction:column}figcaption{font-size:smaller}.bio{margin-bottom:1rem}::selection{background-color:#fffba0;color:#333}.search-article{position:relative}.search-article label[for="search-input"]{position:relative;top:-10px;left:11px}.search-article input[type="search"]{top:-1rem;left:0;border:0;width:100%;height:30px;outline:none;position:absolute;border-radius:5px;padding:10px 10px 10px 35px;color:var(--main-text-color);-webkit-appearance:none;background-color:rgba(128,128,128,0.1);border:1px solid rgba(128,128,128,0.1)}.search-article input[type="search"]::-webkit-input-placeholder{color:#808080}.search-article input[type="search"]::-webkit-search-decoration,.search-article input[type="search"]::-webkit-search-results-decoration{display:none}#search-results{text-align:center}#search-results li{text-align:center}#search-results li::before{content:"›";display:inline-block;margin-left:-1.3em;width:1.3em;color:var(--main-text-color)}.post-nav{display:flex;position:relative;margin-top:0;border-top:2px solid var(--light-text-color);line-height:1.4}.post-nav .post-nav-item{border-bottom:0;padding-bottom:10px;width:50%;padding-top:10px;text-decoration:none;box-sizing:border-box}.post-nav .post-nav-item .post-title{color:var(--main-text-color)}.post-nav .post-nav-item:hover .post-title,.post-nav .post-nav-item:focus .post-title{color:var(--link-color);opacity:0.9}.post-nav .post-nav-item .nav-arrow{font-size:17px;color:var(--main-text-color);margin-bottom:3px;font-weight:bold}.post-nav .post-nav-item:nth-child(odd){padding-left:0;padding-right:20px}.post-nav .post-nav-item:nth-child(even){text-align:right;padding-right:0;padding-left:20px}.tags ul{list-style:none;display:grid;grid-template-columns:auto auto auto auto auto auto;grid-template-rows:auto auto auto auto}.tags li{white-space:normal;text-overflow:ellipsis}.timeline{position:center;width:650px;margin:-6em auto;padding:1px;list-style-type:none}@media (max-width: 860px){.timeline{width:100%}}.timeline:before{position:absolute;left:50%;top:0;content:' ';display:block;width:6px;height:100%;margin-left:-3px;background:var(--light-text-color);z-index:5}@media (max-width: 375px){.timeline:before{height:150%}}.timeline li{padding:2em 0}@media (max-width: 860px){.timeline li{padding:2em 0}}.timeline li::after{content:"";display:block;height:150%;clear:both;visibility:hidden}.direction-l{position:relative;width:287px;float:left;text-align:right}@media (max-width: 860px){.direction-l{float:none;width:100%;text-align:center}}.direction-l .flag{color:#333;box-shadow:-1px 1px 1px rgba(0,0,0,0.52)}.direction-l .flag:after{content:"";position:absolute;left:100%;top:50%;height:0;width:0;margin-top:-8px;border:solid transparent;border-left-color:#f8f8f8;border-width:8px;pointer-events:none}@media (max-width: 860px){.direction-l .flag:after{content:"";position:absolute;left:50%;top:-8px;height:0;width:0;margin-left:-8px;border:solid transparent;border-bottom-color:#fff;border-width:8px;pointer-events:none}}.direction-l .time-wrapper{float:left}@media (max-width: 860px){.direction-l .time-wrapper{float:none}}.direction-r{position:relative;width:293px;float:right;text-align:left}@media (max-width: 860px){.direction-r{float:none;width:100%;text-align:center}}.direction-r .flag{color:#333;box-shadow:1px 1px 1px rgba(0,0,0,0.52)}.direction-r .flag:after{content:"";position:absolute;right:100%;top:50%;height:0;width:0;margin-top:-8px;border:solid transparent;border-right-color:#f8f8f8;border-width:8px;pointer-events:none}@media (max-width: 860px){.direction-r .flag:after{content:"";position:absolute;left:50%;top:-8px;height:0;width:0;margin-left:-8px;border:solid transparent;border-bottom-color:#fff;border-width:8px;pointer-events:none}}.direction-r .flag:before{left:-40px}.direction-r .time-wrapper{float:right}@media (max-width: 860px){.direction-r .time-wrapper{float:none}}.flag-wrapper{position:relative;display:inline-block;text-align:center}@media (max-width: 860px){.flag-wrapper{text-align:center}}.flag-wrapper .flag{position:relative;display:inline;background:#f8f8f8;padding:6px 10px;border-radius:5px;font-weight:600;text-align:left}@media (max-width: 860px){.flag-wrapper .flag{background:#fff;z-index:15}}.direction-l .flag:before,.direction-r .flag:before{position:absolute;top:60%;right:-40px;content:' ';display:block;width:12px;height:12px;margin-top:-10px;background:#fff;border-radius:10px;border:4px solid var(--link-color);z-index:10}@media (max-width: 860px){.direction-l .flag:before,.direction-r .flag:before{position:absolute;top:-30px;left:53%;content:' ';display:block;margin-left:-10px}}.time-wrapper{display:inline;line-height:1em;font-size:0.66666em;color:var(--link-color);vertical-align:middle}@media (max-width: 860px){.time-wrapper{display:block;position:relative;margin:4px 0 0 0;z-index:14}}.time-wrapper .time{display:inline-block;padding:4px 6px;background:#f8f8f8}.desc{margin:1em 0.2em -3.5em 0;font-size:0.9em;line-height:1.5em}.desc a{color:var(--link-color);text-decoration:none}.desc a:hover{text-decoration:underline}@media (max-width: 860px){.desc{position:relative;margin:1em 1em 0 1em;padding:1em;background:var(--code-bg-color);box-shadow:0 0 1px rgba(0,0,0,0.2);z-index:15}}.pfp-bio{text-align:center}.home-pfp{width:500px;margin-top:1rem;margin-bottom:1rem;border-radius:0%;border-color:#333;border-width:3px;border-style:solid;opacity:1}.posts{margin-top:1rem}</style></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-3EP7KLCYVP"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-3EP7KLCYVP'); </script><body><main><section class="post"><div class="flex-row-between"> <a href="https://gueepo.me/">« back</a> <button title="Change theme" id="theme-toggle" onclick="modeSwitcher()"><div></div></button></div><time datetime="2018-01-10T13:37:20+01:00">Jan 10, 2018 - 7 ' read</time><h1 class="title"> Setting Up Circle CI on GitHub for C++ and CMake</h1><span class="meta"> </span><p>It’s been 3 months or more since I started my internship on automated testing. I studied and learned about docker, testing libraries, automated testing (of course), continuous development and, finally, continuous integration. Knowing about all of this made me a programmer twice as better than I was. This is a lot of improvement for 3 months and some days. So I started picking interest in testing related tasks also on personal projects and on my most recent one I decided to set up a CI environment on GitHub.</p><p>I had a bit of trouble configuring it at first and I couldn’t find a lot of help from the internet, I had to pick some things here and there but there wasn’t an unique resource about what I wanted to do. Well, now there is since I decided to write about it.</p><h2 id="what-is-continuous-integration--ci"> What is Continuous Integration ? (CI) <a href="#what-is-continuous-integration--ci">#</a></h2><p>Keeping it simple, it is building a pipeline that will be executed in every commit at your most updated branch on git, this pipeline builds (usually using a container) the whole environment needed for the tests and execute all the tests you’ve coded. If all tests pass, you are happy and the changes were successful. In a real life scenario, you can ship your software after this step. If any test fail, you can fix it as soon as possible, this is better than finding out about bugs when you wrote 1000 lines of extra code relying on that buggy function.</p><p>There is also a Management side to it. Software Engineering used to be all about interviewing your client and then developing the software apart from your client, doesn’t take much to know that everything went wrong on this model. Nowadays we use Agile methodologies (i.e. Scrum) and try to deliver to the client as fast as we can.</p><p>As deliveries are fast, so is development, commits and everything else basically. So you <strong>need</strong> a way to verify that every new feature won’t break what is already there. Imagine your client is happy with two pieces of your product, you give to them the third piece but it breaks the other two, not good.</p><p>If you have good and automated software testing covering an important part of your product, you are less likely to deploy something broken to your client, which is nice.</p><p><img src="/images/techblog/debugging-finn.jpg" alt="No More Rubber Duck Debugging!" /></p><p><em>No More Rubber Duck Debugging! Or… Plastic Finn Debugging, anyway… You got it.</em></p><h2 id="what-are-we-going-to-do"> What are we going to do? <a href="#what-are-we-going-to-do">#</a></h2><p>Basically setting up a really simple project with C++ and CMake, write tests for it and then use Circle CI to test it at every update.</p><ol><li><strong>The C++ Code:</strong> I will use a simple class I’m using in a current project, the <em>Point</em> class, it has two attributes, x and y, and some methods to manipulate them, that’s all.</li><li>CMake File.</li><li>Writing Tests for the Point Function (using Catch).</li><li>Building and Running Locally the Tests.</li><li>Setting Up Circle CI.</li></ol><h2 id="doing-it"> Doing it. <a href="#doing-it">#</a></h2><p>This is by no means a C++, CMake, Unit Testing or Catch sort of tutorial, I’m assuming that you know them or have at least some familiarity to understand the code below. Anyway, the code should be pretty straightforward for anyone with some programming background. The code is publicly available <a href="https://github.com/guilhermepo2/cpp-cmake-circle-ci">here</a>.</p><h3 id="the-c-code"> The C++ Code <a href="#the-c-code">#</a></h3><h4 id="pointhpp"> point.hpp <a href="#pointhpp">#</a></h4><div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#ifndef __POINT__
#define __POINT__
</span>
<span class="k">class</span> <span class="nc">Point</span> <span class="p">{</span>
<span class="nl">private:</span>
    <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">y</span><span class="p">;</span>
<span class="nl">public:</span>
    <span class="n">Point</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">const</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="n">getX</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">const</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="n">getY</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">;</span> <span class="p">}</span>
    <span class="kr">inline</span> <span class="kt">void</span> <span class="n">setX</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span> <span class="p">}</span>
    <span class="kr">inline</span> <span class="kt">void</span> <span class="n">setY</span><span class="p">(</span><span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="cp">#endif
</span></code></pre></div></div><h3 id="cmake-file"> CMake File <a href="#cmake-file">#</a></h3><div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cmake_minimum_required</span><span class="p">(</span><span class="n">VERSION</span> <span class="mf">2.8</span><span class="p">)</span>
<span class="n">set</span><span class="p">(</span><span class="n">CMAKE_CXX_STANDARD</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">project</span><span class="p">(</span><span class="n">cpp</span><span class="o">-</span><span class="n">cmake</span><span class="o">-</span><span class="n">circle</span><span class="o">-</span><span class="n">ci</span><span class="p">)</span>

<span class="n">set</span><span class="p">(</span><span class="n">EXECUTABLE_OUTPUT_PATH</span> <span class="err">$</span><span class="p">{</span><span class="n">CMAKE_SOURCE_DIR</span><span class="p">}</span><span class="o">/</span><span class="n">bin</span><span class="p">)</span>
<span class="n">add_executable</span><span class="p">(</span><span class="n">point_test</span> <span class="err">$</span><span class="p">{</span><span class="n">PROJECT_SOURCE_DIR</span><span class="p">}</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">pointTest</span><span class="p">.</span><span class="n">cpp</span><span class="p">)</span>
</code></pre></div></div><h3 id="writing-tests-for-the-point-function"> Writing Tests for the Point Function <a href="#writing-tests-for-the-point-function">#</a></h3><p>For testing in C++, I like the <a href="https://github.com/catchorg/Catch2">Catch2</a> library.</p><h4 id="pointtestcpp"> pointTest.cpp <a href="#pointtestcpp">#</a></h4><div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define CATCH_CONFIG_MAIN
#include "libs/catch.hpp"
#include "point.hpp"
</span>
<span class="n">TEST_CASE</span><span class="p">(</span><span class="s">"Creating a Point"</span><span class="p">,</span> <span class="s">"[point]"</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Point</span> <span class="n">p</span><span class="p">;</span>

    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">getX</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">getY</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">TEST_CASE</span><span class="p">(</span><span class="s">"Creating and Setting Values to a Point"</span><span class="p">,</span> <span class="s">"[point]"</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Point</span> <span class="n">p</span><span class="p">;</span>
    <span class="n">p</span><span class="p">.</span><span class="n">setX</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">p</span><span class="p">.</span><span class="n">setY</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>

    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">getX</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">);</span>
    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">getY</span><span class="p">()</span> <span class="o">==</span> <span class="mi">3</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><h3 id="building-using-cmake-and-executing-the-tests"> Building using CMake and executing the tests. <a href="#building-using-cmake-and-executing-the-tests">#</a></h3><p><img src="/images/techblog/point-test.png" alt="It works!!" /></p><p>Yay! Now we have a point class and we have succesfully tested it, we can now peacefully create points whenever we want and we will trust the code works because the test said it does, now let’s set up the CI environment!.</p><h3 id="setting-up-the-ci-environment"> Setting UP the CI Environment <a href="#setting-up-the-ci-environment">#</a></h3><p>The Continuous Integration environment I’m going to use is <a href="https://circleci.com">Circle CI</a>. I encourage you to visit their website and skim through what it does and on the documentation.</p><p>When you are ready, Sign Up. It is easier to use your GitHub account, but do what you like the most. Go to your <a href="https://github.com">GitHub</a> page and visit the <a href="https://github.com/marketplace">Marketplace</a>, you will find <em>Circle CI</em> under the Continuous Integration category or you can just search for it. If you want the direct link <a href="https://github.com/marketplace/circleci">here it is</a>. “Buy” it (it’s not buying since it’s free, although it has paid options).</p><p>Now on CircleCI, Log In if you haven’t already, you should be seeing your Dashboard. Link it with GitHub, if you haven’t already, to have access to your repositories. Add a <em>New Project</em> on the <em>Projects</em> session and choose your desired Repository, click on Setup Project. Image Below for better understanding.</p><p><img src="/images/techblog/project-on-circle-ci.png" alt="Project on Circle CI" /></p><p>You will read the following:</p><blockquote><p>CircleCI helps you ship better code, faster. To kick things off, you’ll need to add a config.yml file to your project, and start building. After that, we’ll start a new build for you each time someone pushes a new commit.</p></blockquote><p>It comes pretty much all set for you, we usually want to use Linux Operating System and the version 2.0.</p><p>Now we have to do as Circle CI says:</p><blockquote><p>Create a folder named .circleci and add a file config.yml (so that the filepath be in .circleci/config.yml).</p></blockquote><p>Unfortunately, there isn’t a sample <code class="language-plaintext highlighter-rouge">config.yml</code> file for our project settings, so I will guide you through it. If you aren’t very familiar with .yml files, I suggest that you <a href="http://yaml.org">read more</a> about it. Also, if you aren’t very familiar with docker or containers, I suggest you <a href="https://www.docker.com">to be</a>. <em>Please, consider learning more about Docker. As you can read on docker’s main page: Build, Ship, and Run Any App, Anywhere - Pretty powerful, eh?</em></p><h4 id="the-configyml-file"> The config.yml file <a href="#the-configyml-file">#</a></h4><p>For testing in the Circle CI, a docker container is used, we are going to use the image <em>debian:stretch</em>, which is a simple Linux Image with few functionalities, so we are going to need to install what we are effectively going to use: <strong>sudo</strong>, <strong>gcc and g++</strong> and, finally, <strong>cmake</strong>.</p><p>Every .yml file begins with the current version, which for this case is <code class="language-plaintext highlighter-rouge">version 2</code>.</p><p>We need to define our <strong>jobs</strong>, a job is a task executed on the continuous integration environment. We will call our job <em>build</em> and, for this simple scenario, we are going to do everything in this job. The build job needs to have a defined docker image and its steps are:</p><ol><li>Installing SUDO</li><li>Installing GCC and G++</li><li>Installing CMAKE</li><li>Creating the Build Files</li><li>Building the Project</li><li>Executing the point test</li></ol><p><strong>obs:</strong> it is common to execute unit tests on the build routine, it is common to not do it. Your project, your resources, your decision.</p><p><strong>obs2:</strong> <em>.yml</em> files are determined by 2-space indentation, so be careful when writing your own.</p><p>The first thing to do on a <em>.yml</em> file is to declare we have a <em>job</em>, in this case we are going to have only one job. A job requires its, well, job. Which in this case is the <em>build</em> job.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>version: 2

jobs:
  build:
</code></pre></div></div><p><em>Be careful on the identation!!!</em></p><p>The build job requires two things: (i) a <em>docker</em> image, and (ii) its <em>steps</em>, where the magic effectively will happen.</p><p>A good docker image on this is the image <em>“debian:stretch”</em> and down here is an example with the step to install SUDO.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>version: 2

jobs:
  build:
    docker:
      - image: "debian:stretch"
    steps:
      - checkout
      - run:
          name: Installing SUDO
          command: 'apt-get update &amp;&amp; apt-get install -y sudo &amp;&amp; rm -rf /var/lib/apt/lists/*'
</code></pre></div></div><p>I could waste your time and my time here writing about each step, but I’m just going to show you the final config.yml file to build everything needed for running a C++ Project with CMAKE and run its Unit Tests.</p><p>There’s not much secret to it, it’s all about writin the right <em>.yml</em> config.</p><h4 id="the-final-configyml-file"> The final config.yml file: <a href="#the-final-configyml-file">#</a></h4><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>version: 2

jobs:
  build:
    docker:
      - image: "debian:stretch"
    steps:
      - checkout
      - run:
          name: Installing SUDO
          command: 'apt-get update &amp;&amp; apt-get install -y sudo &amp;&amp; rm -rf /var/lib/apt/lists/*'
      - run:
          name: Installing GCC
          command: 'apt-get update &amp;&amp; apt-get install -y gcc g++'
      - run:
          name: Install CMAKE
          command: 'apt-get update &amp;&amp; sudo apt-get install -y cmake'
      - run:
          name: Creating Build Files
          command: 'cmake -H. -Bbuild'
      - run:
          name: Creating Binary Files
          command: 'cmake --build build'
      - run:
          name: Point Unit Testing
          command: './bin/point_test'
</code></pre></div></div><p>Everything is finally set up. Commit and Push the <em>config.yml</em> file and let’s do some minor changes on our project to see if it really works.</p><p>It’s obvious that I got a bit lost while writing the final of this article as explaining how to config with a .yml is something a bit… I don’t know. So any thing you would to ask about it just reach me on twitter or email or anywhere else.</p></section><!--<section><nav class="post-nav"> <a class="post-nav-item post-nav-next" href="/2018/07/16/a-better-random-alternative"><div class="nav-arrow">Next</div><span class="post-title">A Better Random Alternative to Straight Random Range</span> </a></nav></section>--><hr></main><script> function setTheme(theme) { if (theme === "dark") { document.documentElement.setAttribute('data-theme', 'dark'); window.localStorage.setItem('theme', 'dark'); document.getElementById("theme-toggle").classList.add('sun'); document.getElementById("theme-toggle").classList.remove('moon'); } else { document.documentElement.setAttribute('data-theme', 'light'); window.localStorage.setItem('theme', 'light'); document.getElementById("theme-toggle").classList.add('moon'); document.getElementById("theme-toggle").classList.remove('sun'); } } let theme = localStorage.getItem('theme'); theme = theme || (window.matchMedia ? window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light' : 'light'); setTheme(theme); function modeSwitcher() { let currentMode = document.documentElement.getAttribute('data-theme'); if (currentMode === "dark") { setTheme('light'); } else { setTheme('dark'); } } </script></body><footer class="social-footer"><div class="social-footer-icons"><p>based on the template <a href="https://github.com/DavideBrie/Gesko" title="Browse the code" target="_blank" rel="noopener noreferrer">gesko</a></p></div></footer></html>
