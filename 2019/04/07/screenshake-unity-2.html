<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="https://gueepo.me/assets/css/syntax.css"><link rel="preconnect" href="https://cdnjs.cloudflare.com"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><title> Even better Screenshake in Unity! - gueepo</title><link rel="shortcut icon" href="https://gueepo.me/favicon.png"><link rel="alternate" type="application/atom+xml" title="gueepo" href="https://gueepo.me/atom.xml"><link rel="alternate" type="application/json" title="gueepo" href="https://gueepo.me/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="https://gueepo.me/sitemap.xml" /><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Play:wght@400;700&family=Source+Code+Pro:ital,wght@0,200;0,300;0,400;0,600;0,700;0,900;1,300;1,400;1,500;1,600;1,700;1,900&display=swap" rel="stylesheet"><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}html{font-size:15px}#theme-toggle{opacity:0.65;position:relative;border-radius:5px;height:25px;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;transition:opacity 0.3s ease 0s;border:none;outline:none;background:none;cursor:pointer;padding:0px;appearance:none;transform:scale(0.8)}html,html[data-theme="light"]{--text-font: Play;--source-code-font: Source Code Pro;--very-light-text-color: rgb(222, 222, 222);--light-text-color: rgb(89, 183, 255);--medium-text-color: #555;--main-text-color: #333;--highlight-text-color: #6cb4a0;--dark-text-color: #393e46;--link-color: rgb(50, 87, 209);--code-bg-color: rgb(245, 245, 245);background-color:#fff}html #theme-toggle div,html[data-theme="light"] #theme-toggle div{position:relative;width:24px;height:24px;border-radius:50%;border:none;background-color:var(--theme-ui-colors-transparent, transparent);transform:scale(1);transition:all 0.45s ease 0s;overflow:hidden;box-shadow:inset 8px -8px 0px 0px var(--theme-ui-colors-toggleIcon, #2d3748)}html #theme-toggle div::before,html[data-theme="light"] #theme-toggle div::before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:none;border-radius:50%;transform:translate(0px, 0px);opacity:1;transition:transform 0.45s ease 0s}html #theme-toggle div::after,html[data-theme="light"] #theme-toggle div::after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0px 0px -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon, #2d3748),0 23px 0 var(--theme-ui-colors-toggleIcon, #2d3748),23px 0 0 var(--theme-ui-colors-toggleIcon, #2d3748),-23px 0 0 var(--theme-ui-colors-toggleIcon, #2d3748),15px 15px 0 var(--theme-ui-colors-toggleIcon, #2d3748),-15px 15px 0 var(--theme-ui-colors-toggleIcon, #2d3748),15px -15px 0 var(--theme-ui-colors-toggleIcon, #2d3748),-15px -15px 0 var(--theme-ui-colors-toggleIcon, #2d3748);transform:scale(0);transition:all 0.35s ease 0s}html[data-theme="dark"]{--text-font: Play;--source-code-font: Source Code Pro;--very-light-text-color: #EEE;--light-text-color: #c4bbf0;--medium-text-color: #52057b;--main-text-color: #EAEAEA;--highlight-text-color: #6cb4a0;--dark-text-color: rgb(36, 38, 42);--link-color: rgb(255, 89, 125);--code-bg-color: rgb(36, 38, 42);background-color:#131418}html[data-theme="dark"] #theme-toggle div{position:relative;width:24px;height:24px;border-radius:50%;border:4px solid var(--theme-ui-colors-toggleIcon, #cbd5e0);background-color:var(--theme-ui-colors-toggleIcon, #cbd5e0);transform:scale(0.55);transition:all 0.45s ease 0s;overflow:visible;box-shadow:none}html[data-theme="dark"] #theme-toggle div::before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:2px solid var(--theme-ui-colors-toggleIcon, #cbd5e0);border-radius:50%;transform:translate(14px, -14px);opacity:0;transition:transform 0.45s ease 0s}html[data-theme="dark"] #theme-toggle div::after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0px 0px -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),0 23px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),23px 0 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),-23px 0 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),15px 15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),-15px 15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),15px -15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),-15px -15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0);transform:scale(1);transition:all 0.35s ease 0s}body{font-family:var(--text-font),monospace;text-rendering:optimizeLegibility;line-height:1.75;color:var(--main-text-color)}a{color:var(--link-color);text-decoration:none}.post p{margin:1rem 0}.meta{margin:1.4rem 0}code,pre{background:var(--code-bg-color);margin:0 -27px;border-width:1px}code{font-family:var(--source-code-font),monospace;margin:unset;padding:0.1rem;color:var(--highlight-text-color)}pre code{background-color:unset;color:unset}pre{border-width:3px;padding:0.8rem;white-space:pre-wrap;border-style:none none none solid;border-color:var(--light-text-color)}img{max-width:100%}hr{background:var(--light-text-color);height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:0.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem 0}section{margin-top:8rem}blockquote{font-style:italic;border-left:5px solid var(--dark-text-color);padding-left:1rem}h1{color:var(--main-text-color);text-transform:uppercase;font-size:2rem;font-weight:bold;margin-bottom:1.5rem}h2,h3,h4,h5{font-weight:bold;margin-bottom:1.5rem;font-size:2rem}h2{font-size:1.8rem}h3{font-size:1.6rem}h4{font-size:1.4rem}h5{font-size:1.2rem}h6{font-size:1rem}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:0.5rem}.posts>h3{font-weight:500}.post ul{margin:0px;margin:0px 0px 10px 10px}.post ol{margin:0px;margin:0px 0px 10px 15px}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:0.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:bold}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}time{color:var(--main-text-color)}.post>h1.title{font-size:x-large;margin-top:0;margin-bottom:0}.post>time{margin-bottom:0;margin-top:3rem}.highlight{margin:0px}main{display:flex;max-width:47rem;margin:-5rem auto 0;padding-top:2.4rem;padding-bottom:0.0rem;padding-left:2rem;padding-right:2rem;flex-direction:column}.flex-row-between{display:flex;flex-direction:row;justify-content:space-between}.social-footer{padding:1rem;display:flex;justify-content:center;position:initial}.social-footer .social-footer-icons .fa{font-size:1.3rem;color:#a9a9a9}.social-footer .social-footer-icons .fa:hover{color:dimgray;transition:color 0.3s ease-in}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:0.5rem}main{padding:0 2rem}}section{flex-grow:999;display:flex;flex-direction:column}figcaption{font-size:smaller}.bio{margin-bottom:1rem}::selection{background-color:#fffba0;color:#333}.search-article{position:relative}.search-article label[for="search-input"]{position:relative;top:-10px;left:11px}.search-article input[type="search"]{top:-1rem;left:0;border:0;width:100%;height:30px;outline:none;position:absolute;border-radius:5px;padding:10px 10px 10px 35px;color:var(--main-text-color);-webkit-appearance:none;background-color:rgba(128,128,128,0.1);border:1px solid rgba(128,128,128,0.1)}.search-article input[type="search"]::-webkit-input-placeholder{color:#808080}.search-article input[type="search"]::-webkit-search-decoration,.search-article input[type="search"]::-webkit-search-results-decoration{display:none}#search-results{text-align:center}#search-results li{text-align:center}#search-results li::before{content:"›";display:inline-block;margin-left:-1.3em;width:1.3em;color:var(--main-text-color)}.post-nav{display:flex;position:relative;margin-top:0;border-top:2px solid var(--light-text-color);line-height:1.4}.post-nav .post-nav-item{border-bottom:0;padding-bottom:10px;width:50%;padding-top:10px;text-decoration:none;box-sizing:border-box}.post-nav .post-nav-item .post-title{color:var(--main-text-color)}.post-nav .post-nav-item:hover .post-title,.post-nav .post-nav-item:focus .post-title{color:var(--link-color);opacity:0.9}.post-nav .post-nav-item .nav-arrow{font-size:17px;color:var(--main-text-color);margin-bottom:3px;font-weight:bold}.post-nav .post-nav-item:nth-child(odd){padding-left:0;padding-right:20px}.post-nav .post-nav-item:nth-child(even){text-align:right;padding-right:0;padding-left:20px}.tags ul{list-style:none;display:grid;grid-template-columns:auto auto auto auto auto auto;grid-template-rows:auto auto auto auto}.tags li{white-space:normal;text-overflow:ellipsis}.timeline{position:center;width:650px;margin:-6em auto;padding:1px;list-style-type:none}@media (max-width: 860px){.timeline{width:100%}}.timeline:before{position:absolute;left:50%;top:0;content:' ';display:block;width:6px;height:100%;margin-left:-3px;background:var(--light-text-color);z-index:5}@media (max-width: 375px){.timeline:before{height:150%}}.timeline li{padding:2em 0}@media (max-width: 860px){.timeline li{padding:2em 0}}.timeline li::after{content:"";display:block;height:150%;clear:both;visibility:hidden}.direction-l{position:relative;width:287px;float:left;text-align:right}@media (max-width: 860px){.direction-l{float:none;width:100%;text-align:center}}.direction-l .flag{color:#333;box-shadow:-1px 1px 1px rgba(0,0,0,0.52)}.direction-l .flag:after{content:"";position:absolute;left:100%;top:50%;height:0;width:0;margin-top:-8px;border:solid transparent;border-left-color:#f8f8f8;border-width:8px;pointer-events:none}@media (max-width: 860px){.direction-l .flag:after{content:"";position:absolute;left:50%;top:-8px;height:0;width:0;margin-left:-8px;border:solid transparent;border-bottom-color:#fff;border-width:8px;pointer-events:none}}.direction-l .time-wrapper{float:left}@media (max-width: 860px){.direction-l .time-wrapper{float:none}}.direction-r{position:relative;width:293px;float:right;text-align:left}@media (max-width: 860px){.direction-r{float:none;width:100%;text-align:center}}.direction-r .flag{color:#333;box-shadow:1px 1px 1px rgba(0,0,0,0.52)}.direction-r .flag:after{content:"";position:absolute;right:100%;top:50%;height:0;width:0;margin-top:-8px;border:solid transparent;border-right-color:#f8f8f8;border-width:8px;pointer-events:none}@media (max-width: 860px){.direction-r .flag:after{content:"";position:absolute;left:50%;top:-8px;height:0;width:0;margin-left:-8px;border:solid transparent;border-bottom-color:#fff;border-width:8px;pointer-events:none}}.direction-r .flag:before{left:-40px}.direction-r .time-wrapper{float:right}@media (max-width: 860px){.direction-r .time-wrapper{float:none}}.flag-wrapper{position:relative;display:inline-block;text-align:center}@media (max-width: 860px){.flag-wrapper{text-align:center}}.flag-wrapper .flag{position:relative;display:inline;background:#f8f8f8;padding:6px 10px;border-radius:5px;font-weight:600;text-align:left}@media (max-width: 860px){.flag-wrapper .flag{background:#fff;z-index:15}}.direction-l .flag:before,.direction-r .flag:before{position:absolute;top:60%;right:-40px;content:' ';display:block;width:12px;height:12px;margin-top:-10px;background:#fff;border-radius:10px;border:4px solid var(--link-color);z-index:10}@media (max-width: 860px){.direction-l .flag:before,.direction-r .flag:before{position:absolute;top:-30px;left:53%;content:' ';display:block;margin-left:-10px}}.time-wrapper{display:inline;line-height:1em;font-size:0.66666em;color:var(--link-color);vertical-align:middle}@media (max-width: 860px){.time-wrapper{display:block;position:relative;margin:4px 0 0 0;z-index:14}}.time-wrapper .time{display:inline-block;padding:4px 6px;background:#f8f8f8}.desc{margin:1em 0.2em -3.5em 0;font-size:0.9em;line-height:1.5em}.desc a{color:var(--link-color);text-decoration:none}.desc a:hover{text-decoration:underline}@media (max-width: 860px){.desc{position:relative;margin:1em 1em 0 1em;padding:1em;background:var(--code-bg-color);box-shadow:0 0 1px rgba(0,0,0,0.2);z-index:15}}.pfp-bio{text-align:right}.home-pfp{width:200px;margin-top:1rem;margin-bottom:1rem;border-radius:50%;border-color:#333;border-width:3px;border-style:solid;opacity:1}.posts{margin-top:1rem}</style></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-3EP7KLCYVP"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-3EP7KLCYVP'); </script><body><main><section class="post"><div class="flex-row-between"> <a href="https://gueepo.me/techblog/">« back</a> <button title="Change theme" id="theme-toggle" onclick="modeSwitcher()"><div></div></button></div><time datetime="2019-04-07T13:00:00+02:00">Apr 7, 2019 - 6 ' read</time><h1 class="title"> Even better Screenshake in Unity!</h1><span class="meta"> </span><p>Some months ago I wrote about doing Screenshake in Unity, and now I’m writing about an even better way to make Screenshake in Unity! I will just repeat the beggining of the other post here now.</p><p>First things first, if you don’t know what is the <strong>JUICE</strong>, I feel sorry for you. There is a moment, in every game developer’s life, where they get to meet the <strong>JUICE</strong>. It is, for sure, a life changing moment. That being said, if you don’t know what is the <strong>JUICE</strong> you probably have already thought: “My game is bad and I don’t know why” or “My game has a fun mechanic but is bad, why?” - The answer to all your thoughts and problems probably are: <strong>THE JUICE</strong>!.</p><p>Watch <a href="https://www.youtube.com/watch?v=Fy0aCDmgnxg">Juice it or Lose It</a> and <a href="https://www.youtube.com/watch?v=AJdEqssNZ-U">The Art of Screenshake</a> and watch your games improve in 100% just by watching a couple lectures!</p><p>A new addition to these lectures is <a href="https://www.youtube.com/watch?v=tu-Qe66AvtY">Math for Game Programmers: Juicing your Camera with Math</a> - which is a veeery nice talk!</p><h2 id="cool-what-do-i-need"> Cool! What do I need? <a href="#cool-what-do-i-need">#</a></h2><p>After months of iterating to achieve the <strong>optimal screenshake</strong> I reached the following formula: have a GameObject to hold <em>two cameras</em>, yes, two cameras. We don’t want to shake the same camera we use to follow our player or show game events.</p><p>Why not? You might ask! Well, we would need to write extra code to make sure the camera would effectively return to its intended position, and it’s not always trivial and very error-prone, so having a second camera to mirror the intended position and add the shake to it is a better approach in my opinion.</p><p><strong>PS1:</strong> I’m joking about it being the <em>optimal screenshake</em> - it probably has lots of room for improvement and feel free to reach me if you have a tip for it! <strong>PS2:</strong> <a href="https://github.com/fourthdimensionstudio/UnityScripts/blob/master/Utilities/MonoBehaviors/CameraHolder.cs">You can find the code I use here</a>.</p><h2 id="lets-talk-code"> Let’s talk code! <a href="#lets-talk-code">#</a></h2><p><strong>Variables</strong></p><div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">enum</span> <span class="n">EShakeStyle</span> <span class="p">{</span>
    <span class="n">Horizontal</span><span class="p">,</span>
    <span class="n">Vertical</span><span class="p">,</span>
    <span class="n">Angular</span><span class="p">,</span>
    <span class="n">Directional</span><span class="p">,</span>
    <span class="n">All</span>
<span class="p">}</span>
</code></pre></div></div><p>First thing is that I use this enum so I can have control over what kind of shake I want, the names pretty much say by themselves. Horizontal and Vertical shake only on one axis and Angular messes with the camera rotation. Directional messes with <em>both</em> axis and All messes with <strong>everything!</strong></p><div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// The Main Camera, the one who won't shake (probably the one following the player, has its own Script)</span>
<span class="k">public</span> <span class="n">Camera</span> <span class="n">mainCamera</span><span class="p">;</span>

<span class="c1">// Shake Camera, the reason this is a different camera is because we don't want to mess with the real camera position, so we won't have to do extra code to make sure the camera return to its original position.</span>
<span class="k">public</span> <span class="n">Camera</span> <span class="n">screenshakeCamera</span><span class="p">;</span>
</code></pre></div></div><p>Following that, I have the reference to the main camera and the screen shake camera, I like having them as public variables so I can just drag and drop on the Editor.</p><div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// For Angular Screenshake</span>
<span class="k">private</span> <span class="k">const</span> <span class="kt">float</span> <span class="n">maxAngle</span> <span class="p">=</span> <span class="p">.</span><span class="m">5f</span><span class="p">;</span>
<span class="c1">// For Directional Screenshake</span>
<span class="k">private</span> <span class="k">const</span> <span class="kt">float</span> <span class="n">maxOffset</span> <span class="p">=</span> <span class="p">.</span><span class="m">5f</span><span class="p">;</span>

<span class="k">private</span> <span class="kt">float</span> <span class="n">m_cameraTrauma</span><span class="p">;</span>
<span class="k">private</span> <span class="n">EShakeStyle</span> <span class="n">m_shakeStyle</span><span class="p">;</span>
<span class="k">private</span> <span class="n">Coroutine</span> <span class="n">shakeRoutine</span><span class="p">;</span>
</code></pre></div></div><p>Here is where things get interesting, we have the variables to limit how much our rotational and directional shake can be and some control variables!</p><p><strong>The Entry Point!</strong></p><div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">void</span> <span class="nf">AddTraumaToCamera</span><span class="p">(</span><span class="kt">float</span> <span class="n">amount</span><span class="p">,</span> <span class="n">EShakeStyle</span> <span class="n">style</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">SetShakeStyle</span><span class="p">(</span><span class="n">style</span><span class="p">);</span>
    <span class="nf">AddTraumaToCamera</span><span class="p">(</span><span class="n">amount</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><p>The entry point is just adding trauma to the camera, I don’t like using a “Begin Screenshake” functionality, I’m a simple man, if trauma bigger than 0, we shake, if not, we not shake.</p><p><code class="language-plaintext highlighter-rouge">SetShakeStyle(EShakeStyle shakeStyle)</code> is a very simple function that will just attribute whatever shakeStyle was passed to the current shakeStyle.</p><p>On the other hand, <code class="language-plaintext highlighter-rouge">AddTraumaToCamera(float amount)</code> has some interesting things happening.</p><div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">void</span> <span class="nf">AddTraumaToCamera</span><span class="p">(</span><span class="kt">float</span> <span class="n">amount</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">m_cameraTrauma</span> <span class="p">&lt;=</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">screenshakeCamera</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">mainCamera</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">;</span>
        <span class="n">screenshakeCamera</span><span class="p">.</span><span class="n">enabled</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="n">mainCamera</span><span class="p">.</span><span class="n">enabled</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="n">m_cameraTrauma</span> <span class="p">=</span> <span class="n">amount</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">m_cameraTrauma</span> <span class="p">+=</span> <span class="n">amount</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="n">shakeRoutine</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">shakeRoutine</span> <span class="p">=</span> <span class="nf">StartCoroutine</span><span class="p">(</span><span class="nf">ShakeRoutine</span><span class="p">());</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>We either set the trauma or add to it, according to the camera’s previous state. <strong>Attention!</strong> We only initialize the ShakeRoutine if we are not currently executing it! If the screen is already shaking everything will work correctly by just adding to the trauma!</p><p>An important part is where I <strong>deactivate</strong> the main camera and <strong>activate</strong> the screenshake camera, this guarantees that the screenshake camera is the one doing the rendering.</p><p>And then we finally get to our glorious <code class="language-plaintext highlighter-rouge">ShakeRoutine()</code>!</p><div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span> <span class="n">IEnumerator</span> <span class="nf">ShakeRoutine</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">while</span><span class="p">(</span><span class="n">m_cameraTrauma</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">m_cameraTrauma</span> <span class="p">-=</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">;</span>
        <span class="n">screenshakeCamera</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">mainCamera</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">;</span>
        
        <span class="kt">float</span> <span class="n">angle</span> <span class="p">=</span> <span class="n">maxAngle</span> <span class="p">*</span> <span class="p">(</span><span class="n">m_cameraTrauma</span> <span class="p">*</span> <span class="n">m_cameraTrauma</span><span class="p">)</span> <span class="p">*</span> <span class="n">Random</span><span class="p">.</span><span class="nf">Range</span><span class="p">(-</span><span class="m">1f</span><span class="p">,</span> <span class="m">1f</span><span class="p">);</span>
        <span class="kt">float</span> <span class="n">offsetX</span> <span class="p">=</span> <span class="n">maxOffset</span> <span class="p">*</span> <span class="p">(</span><span class="n">m_cameraTrauma</span> <span class="p">*</span> <span class="n">m_cameraTrauma</span><span class="p">)</span> <span class="p">*</span> <span class="n">Random</span><span class="p">.</span><span class="nf">Range</span><span class="p">(-</span><span class="m">1f</span><span class="p">,</span> <span class="m">1f</span><span class="p">);</span>
        <span class="kt">float</span> <span class="n">offsetY</span> <span class="p">=</span> <span class="n">maxOffset</span> <span class="p">*</span> <span class="p">(</span><span class="n">m_cameraTrauma</span> <span class="p">*</span> <span class="n">m_cameraTrauma</span><span class="p">)</span> <span class="p">*</span> <span class="n">Random</span><span class="p">.</span><span class="nf">Range</span><span class="p">(-</span><span class="m">1f</span><span class="p">,</span> <span class="m">1f</span><span class="p">);</span>

        <span class="nf">ShakeWithStyle</span><span class="p">(</span><span class="k">new</span> <span class="nf">Vector2</span><span class="p">(</span><span class="n">offsetX</span><span class="p">,</span> <span class="n">offsetY</span><span class="p">),</span> <span class="n">angle</span><span class="p">);</span>
        <span class="k">yield</span> <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">screenshakeCamera</span><span class="p">.</span><span class="n">enabled</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="n">mainCamera</span><span class="p">.</span><span class="n">enabled</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="n">shakeRoutine</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p><strong>This</strong>, my friends, is where the real magic happens. I got some good insights from the Math for Game Programmers talk about camera, we have the trauma decaying linearly with <code class="language-plaintext highlighter-rouge">Time.deltaTime</code> and our shake is actually quadratic according to <code class="language-plaintext highlighter-rouge">m_cameraTrauma</code>.</p><p>Another important thing is that before calculating any variable, we set the screenshakeCamera position to the same as mainCamera position. Even with the mainCamera disabled its script is working so the shakeCamera always gets the most updated position of the camera!</p><p>What is happening here is that values for the angle and offset to be added to the camera are being calculated, and it is a very simple math: <code class="language-plaintext highlighter-rouge">(m_cameraTrauma * m_cameraTrauma) * Random.Range(-1f, 1f)</code> - this will gives us any value anywhere in between <code class="language-plaintext highlighter-rouge">[-m_cameraTrauma ^2, m_cameraTrauma ^2]</code>.</p><p>Did you realize how beautiful this is? More trauma, more shake! More trauma, more time shaking!</p><p>The <code class="language-plaintext highlighter-rouge">m_cameraTrauma * m_cameraTrauma</code> part of the equation is important because it creates a more smooth shake, reducing the risks of motion sickness and achieving a better feel overall!</p><p>But you might be asking yourself, what about <code class="language-plaintext highlighter-rouge">ShakeWithStyle(Vector2 offset, float angle)</code>?</p><p>This function only executes a switch case on the current shake style and calls <code class="language-plaintext highlighter-rouge">ShakeDirectional(Vector2 offset)</code> and <code class="language-plaintext highlighter-rouge">ShakeRotational(float angle)</code> if needed. Here are these two functions:</p><div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span> <span class="k">void</span> <span class="nf">ShakeDirectional</span><span class="p">(</span><span class="n">Vector2</span> <span class="n">offset</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Vector3</span> <span class="n">t_position</span> <span class="p">=</span> <span class="n">screenshakeCamera</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">;</span>
    <span class="n">t_position</span><span class="p">.</span><span class="n">x</span> <span class="p">+=</span> <span class="n">offset</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
    <span class="n">t_position</span><span class="p">.</span><span class="n">y</span> <span class="p">+=</span> <span class="n">offset</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
    <span class="n">screenshakeCamera</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">t_position</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">ShakeRotational</span><span class="p">(</span><span class="kt">float</span> <span class="n">offset</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Vector3</span> <span class="n">t_rotation</span> <span class="p">=</span> <span class="n">screenshakeCamera</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localEulerAngles</span><span class="p">;</span>
    <span class="n">t_rotation</span><span class="p">.</span><span class="n">z</span> <span class="p">+=</span> <span class="n">offset</span><span class="p">;</span>
    <span class="n">screenshakeCamera</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localEulerAngles</span> <span class="p">=</span> <span class="n">t_rotation</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>We just add to our Screenshake Camera, all the magic is performed on the Shake Routine. Always remember you can see the whole code <a href="https://github.com/fourthdimensionstudio/UnityScripts/blob/master/Utilities/MonoBehaviors/CameraHolder.cs">here!</a></p><p>And this is how I’m currently doing Screenshake in Unity!</p><p>I know these kind of posts might not be the most interesting since I’m mainly walking you through a piece of code, but I think it is really important to share these tips with everyone! So I’m trying.</p><p>Have a good day and always remember the <strong>JUICE!</strong></p><p>If you are feeling venturous enough, you can follow me on <a href="http://twitter.com/guilhermepo2">Twitter</a> or check my own game studio, <a href="https://fourthdimension.studio">Fourth Dimension</a>.</p></section><!--<section><nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/2018/12/01/what-if-everyone-handles-their-persistence"><div class="nav-arrow">Previous</div><span class="post-title">What if everyone handles their own persistence?</span> </a> <a class="post-nav-item post-nav-next" href="/2019/07/03/simple-state-machines"><div class="nav-arrow">Next</div><span class="post-title">Coding a simple State Machine</span> </a></nav></section>--><hr></main><script> function setTheme(theme) { if (theme === "dark") { document.documentElement.setAttribute('data-theme', 'dark'); window.localStorage.setItem('theme', 'dark'); document.getElementById("theme-toggle").classList.add('sun'); document.getElementById("theme-toggle").classList.remove('moon'); } else { document.documentElement.setAttribute('data-theme', 'light'); window.localStorage.setItem('theme', 'light'); document.getElementById("theme-toggle").classList.add('moon'); document.getElementById("theme-toggle").classList.remove('sun'); } } let theme = localStorage.getItem('theme'); theme = theme || (window.matchMedia ? window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light' : 'light'); setTheme(theme); function modeSwitcher() { let currentMode = document.documentElement.getAttribute('data-theme'); if (currentMode === "dark") { setTheme('light'); } else { setTheme('dark'); } } </script></body><footer class="social-footer"><div class="social-footer-icons"><p>based on the template <a href="https://github.com/DavideBrie/Gesko" title="Browse the code" target="_blank" rel="noopener noreferrer">gesko</a></p></div></footer></html>
